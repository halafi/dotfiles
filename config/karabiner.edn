; legend -> https://johnlindquist.com/customize-karabiner-with-goku/
; docs -> https://github.com/yqrashawn/GokuRakuJoudo/blob/master/tutorial.md
; example -> https://github.com/kchen0x/k-goku
; simlayers -> https://gist.github.com/gsinclair/f4ab34da53034374eb6164698a0a8ace
{
        :profiles {:Default {:default true :sim 50 :delay 500 :alone 500 :held 500}}
        :applications {
                       :terminals ["^com\\.apple\\.Terminal$" "^com\\.googlecode\\.iterm2$"],
                       :alfred ["^com\\.runningwithcrayons\\.Alfred$"]
                       }
        :layers {
                :hyper-mode {:key :caps_lock :alone {:key :escape}} ; ctrl+caps for caps toggle
        }
        :simlayers {
                :alfred-mode {:key :z}
                :tmux-mode {:key :1 :condi :terminals}
        }
        :templates {
                :open "open \"%s\""
                :alf "open /Applications/Alfred\\ 5.app && osascript -e 'tell application \"Alfred 5\" to search \"%s\"'"
        }
        :main [
                {:des "Map shift+ESC to ~, LCMD+ESC to `"
                 :rules [[:!Cescape :grave_accent_and_tilde]
                        [:!Sescape :!Sgrave_accent_and_tilde]
                        [:!Rescape :!Rgrave_accent_and_tilde]
                        ]}
                {:des "Map shift+backspace to del"
                 :rules [[:!Sdelete_or_backspace :delete_forward]
                        ]}

                {:des "Alfred Mode"
                 :rules [:alfred-mode
                        [:spacebar [[:alf ""]]] ; entering alfred this way gets me out of terminal properly
                        [:r [[:alf "repo "]]]
                        [:p [[:alf "pr "]]]
                        [:l [[:alf "lh "]]]
                        [:e [[:alf "emoji "]]]
                        [:s [[:alf "sleep"]]]
                        [:d [[:alf "duck "]]]
                         ]}

                {:des "Tmux Mode"
                 :rules [:tmux-mode
                        [:comma [:!Ta :comma]] ; rename window
                        [:open_bracket [:!Ta :open_bracket]] ; [ - reorder
                        [:close_bracket [:!Ta :close_bracket]]; ] - reorder
                        [:backslash [:!Ta :backslash]] ; menu
                        [:spacebar [:!Ta :spacebar]] ; create window
                        ; top row
                        [:w [:!Ta :w]] ; window selector
                        [:r [:!Ta :r]] ; reload config
                        [:t [:!Ta :t]] ; vertical small split
                        [:i [:!Ta :!Si]] ; reload plugins
                        [:p [:!Ta :p]] ; create window
                        ; home row
                        [:f [:!Ta :!St]] ; fullscreen
                        [:s [:!Ta :s]] ; horizontal split
                        [:h [:!Ta :h]] ; horizontal split
                        [:j [:!Ta :j]] ; pane left
                        [:k [:!Ta :k]] ; pane right
                        [:l [:!Ta :l]]
                        ; bottom row
                        [:x [:!Ta :x]] ; kill pane
                        [:c [:!Ta :c]] ; create window
                        [:v [:!Ta :v]] ; vertical split
                        [:m [:!Ta :z]] ; toggle pane zoom
                        ]}

               {:des "Hyper Mode - Media Keys, Usable everywhere"
                :rules [:hyper-mode
                        ; media keys
                        [:1 :display_brightness_decrement]
                        [:2 :display_brightness_increment]
                        [:3 :mission_control]
                        [:4 :launchpad]
                        [:5 :illumination_decrement]
                        [:6 :illumination_increment]
                        [:7 :rewind]
                        [:8 :play_or_pause]
                        [:9 :fastforward]
                        [:0 :mute]
                        [:hyphen :volume_decrement]
                        [:equal_sign :volume_increment]
                        ; quick access - free keys used
                        [:e [:open "/Applications/NotePlan 3.app"]]
                        [:i [:open "/Applications/iTerm.app"]]
                        [:o [:open "/Applications/Google Chrome.app"]]
                        ; home row
                        [:a [:open "/Applications/Alfred 5.app"]]
                        [:s [:open "/Applications/Slack.app"]]
                        [:g [:open "/Applications/Postico 2.app"]]
                        [:t [:open "/Applications/Spotify.app"]]
                        [:y [:open "/Applications/Visual Studio Code.app"]]
                        ]}

               {:des "Hyper Mode - Partial CTRL Mapping [VIM <C-*> key support]"
                :rules [:hyper-mode
                        ; top row
                        [:q :!Tq :terminals]
                        [:w :!Tw :terminals]
                        [:r :!Tr :terminals]
                        [:s :!Ts :terminals]
                        [:u :!Tu :terminals]
                        [:p :!Tp :terminals]
                        ; home row
                        [:d :!Td :terminals]
                        [:f :!Tf :terminals]
                        [:h :!Th :terminals]
                        [:j :!Tj :terminals]
                        [:k :!Tk :terminals]
                        [:l :!Tl :terminals]
                        ; bottom row
                        [:z :!Tz :terminals] ; suspend, resume with fg %1
                        [:x :!Tx :terminals]
                        [:c :!Tc :terminals]
                        [:v :!Tv :terminals]
                        [:n :!Tn :terminals]
                        [:m :!Tleft_arrow :terminals] ; arrow -> tmux window size
                        [:period :!Tright_arrow :terminals] ; arrow -> tmux window size
                        ]}

               {:des "Hyper Mode - Navigation [VI style]"
                :rules [:hyper-mode
                        [:h :left_arrow :!terminals]
                        [:j :down_arrow :!terminals]
                        [:k :up_arrow :!terminals]
                        [:l :right_arrow :!terminals]
                        ; text selection with shift
                        [:!Sh :!Sleft_arrow :!terminals]
                        [:!Sl :!Sright_arrow :!terminals]
                        [:!Sj :!SCleft_arrow :!terminals]
                        [:!Sk :!SCright_arrow :!terminals]
                        ; alt + hjkl = alt + arrows (move by words)
                        [:!Oj :!Odown_arrow :!terminals]
                        [:!Ok :!Oup_arrow :!terminals]
                        [:!Oh :!Oleft_arrow :!terminals]
                        [:!Ol :!Oright_arrow :!terminals]
                        ]}
        ]
}

